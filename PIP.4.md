# 项目接口页面(Project Interface Page)
- 状态：Draft
- 作者：Zhang Ji zhangji@parsec.com.cn

## 1. 默认布局
### 1.1. 概述
1. 所有页面包含：a)位于左边的sidebar区域，用于显示接口树形结构。；b)位于右边的container区域。
2. container区域分为两类：a)分类详情container；b)接口详情container。

## 2. sidebar区域
1. 树形结构上所有的节点都是“分类”。
2. 一定会有根结点，名称叫做“全部”或表示全部的图标。
3. 鼠标点击分类节点，右边container应该显示分类详情container。
4. 鼠标hover在分类节点时，应该显示如下按钮：a)添加分类；b)编辑分类（根节点不显示）；c)删除分类（根结点不显示）。
5. 点击「添加分类」按钮，应该弹出模态框。
   * 模态框应该包含form表单，输入项包括：a)分类名；b)「提交」和「取消」按钮。
   * 提交添加分类后，sidebar应该出现新的分类，排在下一级的第一位。
6. 点击「删除分类」按钮，应该弹出模态框。
   * 应该显示如下：“是否确认删除分类 {分类名} 及其包含的所有分类和接口？”
   * 模态框应该包含「确认删除」按钮和「取消」按钮。
   * 如果删除sidebar当前选中的分类，则删除之后sidebar区域不选中任何分类，container区域显示空白。

## 3. 分类详情container区域
1. 应该显示当前分类名称。
2. 应该显示当前分类包含的所有接口列表，每个接口的字段包括：a)接口名称；b)接口路径；c)接口分类；d)接口状态。
   * 接口路径应该显示“方法(method)”和“路径(path)”。
3. 应该显示「添加接口」按钮，点击按钮应该弹出模态框。
   * 模态框应该包含form表单，输入项包括：a)接口名称（单行输入框）；b)接口路径（方法：下拉菜单，路径：单行输入框）；c)「提交」和「取消」按钮。

## 4. 接口详情container区域
### 4.1. container区域顶部应该显示tab，包含：a)预览；b)编辑；c)Mock。

### 4.2. 接口详情-预览tab
1. 预览tab内容应该包含如下部分：a)基本信息；b)请求参数；c)返回数据。

#### 4.2.1 基本信息部分
1. 标题为"{接口名称}"
2. 应该显示接口名称。
3. 应该显示接口路径（方法+路径）。
4. 应该显示“Mock地址”超链接。
5. 应该显示接口状态。
6. 应该显示接口描述。
7. 应该显示创建时间和创建者姓名。
8. 应该显示更新时间和更新者姓名。

#### 4.2.2 请求参数部分概述
1. 标题为“请求参数”。
2. 分为Query和Body两个模块，如果没有设置则不显示。

#### 4.2.3 请求参数-Query模块
1. 子标题为“Query:”。
2. 分为如下子模块：a)Path Params; b)Query Params; c)Header; d)Cookie. 如果没有设置则不显示。
3. 每个子模块应该显示参数表格，不显示表头，表格字段包括：a)字段名；b)字段类型；c)字段描述；d)是否必传。

#### 4.2.4 请求参数-Body模块
1. 子标题为“Body:”。
2. 应该显示Content-Type。
3. 应该显示Header列表（如果没有则不显示）。
4. 应该显示参数表格，不显示表头，表格字段包括：a)字段名；b)字段类型；c)字段描述；d)是否必传。

#### 4.2.5 返回数据部分
1. 标题为“返回数据”。
2. 返回数据支持多个，应该按Status Code和Content-Type排序，显示全部返回数据。
3. 每个返回数据应该显示Status Code。
4. 每个返回数据应该显示Content-Type。
5. 每个返回数据应该显示参数表格，不显示表头，表格字段包括：a)字段名；b)字段类型；c)字段描述。

### 4.3. 接口详情-编辑tab
1. 编辑tab内容应该包含如下部分：a)基本信息；b)请求参数；c)返回数据。
2. 应该包含一个置顶或置底的「保存」按钮。

#### 4.3.1 基本信息部分
1. 应该显示“接口名称”输入框
2. 应该显示“选择分类”输入框，树形选择，单选。
3. 应该显示“接口路径”（方法和路径）和「更改」按钮。
   * 点击「更改」按钮应该弹出模态框。
   * 模态框应该显示接口名称。
   * 模态框应该包含form表单，输入项包括：a)接口路径（方法：下拉菜单，路径：单行输入框）；b)「更改」和「取消」按钮。
4. 应该显示“状态”，单选下拉菜单，选项包括：a)未完成；b)已完成。
5. 应该显示“描述”，多行文本输入。

#### 4.3.2 请求参数部分概述
1. 标题为“请求参数”。

#### 4.3.3 请求参数-Query模块
1. 子标题为“Query:”。
2. 应该显示「显示代码」按钮。
   * 点击按钮显示Query模块对应的Schema代码。
3. 分为如下子模块：a)Path Params; b)Query Params; c)Header; d)Cookie. 如果没有设置则不显示。
4. 应该显示如下按钮：a)添加Query Param; b)添加Header; c)添加Cookie。
   * 点击添加按钮，将在对应的子模块下面新增一个参数。
5. 应该显示参数列表，每个参数包括：a)字段名；b)字段类型；c)字段描述；d)是否必传；e)其他属性；f)「显示代码」按钮；g)mock；h)「删除」按钮。
   * 字段名应该是单行输入框，内容不能为空。
   * 字段类型应该是下拉菜单。
   * 字段描述应该是单行输入框，内容可以为空。
   * 是否必传默认非选中，表示非必传。
   * 其他属性包含：a)format; b)enum; c)整数属性（非整数类型不显示）；字符串属性（非字符串类型不显示）。
   * 点击「显示代码」按钮，显示当前参数的Schema代码。
   * mock按钮应该是单行输入框，但是要点击按钮之后弹出输入框。
   * 点击「删除」按钮，删除当前参数。

#### 4.3.4 请求参数-Body模块
1. 子标题为“Body”。
2. 应该显示「添加Body」按钮。
3. 每个Body应该显示「显示代码」按钮。
   * 点击按钮显示当前Body对应的Schema代码。
4. 每个Body应该显示Content-Type。
   * 采用支持文本过滤的、单选下拉菜单。
   * 默认的Content-Type为application/json。
5. 每个Body应该显示参数列表，每个参数包括：a)「添加子参数」按钮；b)字段名；c)字段类型；d)字段描述；e)是否必传；f)其他属性；g)「显示代码」按钮；h)mock；i)「删除」按钮。

#### 4.3.5 返回数据部分
1. 标题为“返回数据”。
2. 应该显示「添加返回」按钮。
   * 点击按钮应该弹出模态框，设置Status Code，默认为200。
3. 应该显示Status Code。
4. 应该显示「显示代码」按钮。
   * 点击按钮显示当前返回的Schema代码。
5. 每个返回分为Header和Body两个模块。

#### 4.3.5.1 返回数据-Header模块
1. 应该显示「添加Header」按钮。
   * 点击添加新的Header参数。
2. 应该显示「显示代码」按钮。
   * 点击按钮显示Header部分的Schema代码。
3. 应该显示参数列表，每个参数包括：a)字段名；b)字段类型；c)字段描述；d)是否必传；e)其他属性；f)「显示代码」按钮；g)mock；h)「删除」按钮。

#### 4.3.5.2 返回数据-Body模块 
1. 应该显示「显示代码」按钮。
   * 点击按钮显示当前Body部分的Schema代码。
2. 应该显示已选中的Content-Type。
   * 采用为支持文本过滤的、单选下拉菜单。
   * 默认的Content-Type为application/json。
3. 应该显示参数列表，每个参数包括：a)「添加子参数」按钮；b)字段名；c)字段类型；d)字段描述；e)是否必传；f)其他属性；g)「显示代码」按钮；h)mock；i)「删除」按钮。

#### 4.4. 接口详情-Mock tab
1. 应该显示返回列表，每个返回列表只包含Status Code。
2. 每个返回列表下，应该显示Mock列表，每个Mock列表包含：a)「设置生效」按钮；b)Mock名称；c)「编辑」按钮；d)「克隆」按钮；e)「删除按钮」(default不显示)。
3. 默认有一个default mock，默认这个Mock生效。
4. 点击「设置生效」按钮，可以切换生效的Mock。在任意时间，有且仅有一个Mock生效。
5. 点击「编辑」或「克隆」按钮，应该显示「Mock编辑」界面。

#### 4.4.1 接口详情-Mock编辑界面
1. 应该显示Mock名称，为单行输入框。
2. 应该显示克隆来源（default不显示）。
3. 应该显示Mock内容的类型tab，包括：a)Mockjs; b)JSON。
   * 默认显示Mockjs内容。
4. 应该显示Mock内容，为多行文本输入框；应该显示「重置」按钮。
   * 当切换Mock类型tab时，Mock内容也要切换相应格式。
   * mockjs内容和JSON内容与克隆来源保持一致。
   * default的Mockjs内容，应该由Schema自动生成为Mockjs格式。
   * default的JSON内容，应该有Mockjs自动生成为JSON格式。
   * 在类型为Mockjs时点击「重置」按钮，Mock内容应恢复为与克隆来源的Mockjs一致。
   * 在类型为JSON时点击「重置」按钮，Mock内容应该重新由Mockjs生成。
5. 应该显示Status Code和Content-Type。
6. 应该显示Header内容，为多行文本输入框；应该显示「重置」按钮；应该显示「收起/展开」按钮。
   * default的Header内容，应该有Schema自动生成为JSON格式。
   * 点击「重置」按钮，Mock内容应该重新由Schema自动生成为JSON格式。
7. 应该显示调用生效的mock名称列表，可编辑。
   * 含义：当前接口被成功调用后，可自动使若干接口生效。
8. 应该显示「保存」按钮。

#### 5. JSON代码编辑器
1. Schema代码编辑、Mock代码编辑等多行文本输入框，都应该能方便地编辑JSON格式文本。
2. 支持自动缩进，按tab键支持块向右缩进，按shift+tab键支持块向左缩进。
3. 鼠标点击大括号，应该显示出代码块的起止区域。

#### 6. Mock接口机制
1. 每个接口都对应一个可访问的Mock接口。
2. Mock接口按当前生效的mock来返回结果
   * 返回的body为mock内容的JSON内容。
   * 返回的header为header内容。
3. 应该根据Content-Type由JSON内容生成对应的返回数据。
   * 如果Content-Type为xml，则将JSON转化为XML格式并返回。
   * 如果Content-Type为excel，则将JSON转化为excel格式并返回。
